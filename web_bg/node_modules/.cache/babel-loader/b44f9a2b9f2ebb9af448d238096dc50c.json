{"remainingRequest":"/Users/zhujunyi/Downloads/Medusa/node_modules/babel-loader/lib/index.js!/Users/zhujunyi/Downloads/Medusa/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhujunyi/Downloads/Medusa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhujunyi/Downloads/Medusa/src/views/table/drag-table.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhujunyi/Downloads/Medusa/src/views/table/drag-table.vue","mtime":1584656670000},{"path":"/Users/zhujunyi/Downloads/Medusa/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhujunyi/Downloads/Medusa/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhujunyi/Downloads/Medusa/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhujunyi/Downloads/Medusa/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvemh1anVueWkvRG93bmxvYWRzL01lZHVzYS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQiKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwoKcmVxdWlyZSgicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIik7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIvVXNlcnMvemh1anVueWkvRG93bmxvYWRzL01lZHVzYS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMi9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3IiKSk7Cgp2YXIgX2FydGljbGUgPSByZXF1aXJlKCJAL2FwaS9hcnRpY2xlIik7Cgp2YXIgX3NvcnRhYmxlanMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInNvcnRhYmxlanMiKSk7CgovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwp2YXIgX2RlZmF1bHQgPSB7CiAgbmFtZTogJ0RyYWdUYWJsZScsCiAgZmlsdGVyczogewogICAgc3RhdHVzRmlsdGVyOiBmdW5jdGlvbiBzdGF0dXNGaWx0ZXIoc3RhdHVzKSB7CiAgICAgIHZhciBzdGF0dXNNYXAgPSB7CiAgICAgICAgcHVibGlzaGVkOiAnc3VjY2VzcycsCiAgICAgICAgZHJhZnQ6ICdpbmZvJywKICAgICAgICBkZWxldGVkOiAnZGFuZ2VyJwogICAgICB9OwogICAgICByZXR1cm4gc3RhdHVzTWFwW3N0YXR1c107CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGlzdDogbnVsbCwKICAgICAgdG90YWw6IG51bGwsCiAgICAgIGxpc3RMb2FkaW5nOiB0cnVlLAogICAgICBsaXN0UXVlcnk6IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIGxpbWl0OiAxMAogICAgICB9LAogICAgICBzb3J0YWJsZTogbnVsbCwKICAgICAgb2xkTGlzdDogW10sCiAgICAgIG5ld0xpc3Q6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlzdDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldExpc3QgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICB2YXIgX3lpZWxkJGZldGNoTGlzdCwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2FydGljbGUuZmV0Y2hMaXN0KSh0aGlzLmxpc3RRdWVyeSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCRmZXRjaExpc3QgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCRmZXRjaExpc3QuZGF0YTsKICAgICAgICAgICAgICAgIHRoaXMubGlzdCA9IGRhdGEuaXRlbXM7CiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsID0gZGF0YS50b3RhbDsKICAgICAgICAgICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMub2xkTGlzdCA9IHRoaXMubGlzdC5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHYuaWQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMubmV3TGlzdCA9IHRoaXMub2xkTGlzdC5zbGljZSgpOwogICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTb3J0KCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICAgIHJldHVybiBfZ2V0TGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0TGlzdDsKICAgIH0oKSwKICAgIHNldFNvcnQ6IGZ1bmN0aW9uIHNldFNvcnQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGVsID0gdGhpcy4kcmVmcy5kcmFnVGFibGUuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbC10YWJsZV9fYm9keS13cmFwcGVyID4gdGFibGUgPiB0Ym9keScpWzBdOwogICAgICB0aGlzLnNvcnRhYmxlID0gX3NvcnRhYmxlanMuZGVmYXVsdC5jcmVhdGUoZWwsIHsKICAgICAgICBnaG9zdENsYXNzOiAnc29ydGFibGUtZ2hvc3QnLAogICAgICAgIC8vIENsYXNzIG5hbWUgZm9yIHRoZSBkcm9wIHBsYWNlaG9sZGVyLAogICAgICAgIHNldERhdGE6IGZ1bmN0aW9uIHNldERhdGEoZGF0YVRyYW5zZmVyKSB7CiAgICAgICAgICAvLyB0byBhdm9pZCBGaXJlZm94IGJ1ZwogICAgICAgICAgLy8gRGV0YWlsIHNlZSA6IGh0dHBzOi8vZ2l0aHViLmNvbS9SdWJhWGEvU29ydGFibGUvaXNzdWVzLzEwMTIKICAgICAgICAgIGRhdGFUcmFuc2Zlci5zZXREYXRhKCdUZXh0JywgJycpOwogICAgICAgIH0sCiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIG9uRW5kKGV2dCkgewogICAgICAgICAgdmFyIHRhcmdldFJvdyA9IF90aGlzMi5saXN0LnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwoKICAgICAgICAgIF90aGlzMi5saXN0LnNwbGljZShldnQubmV3SW5kZXgsIDAsIHRhcmdldFJvdyk7IC8vIGZvciBzaG93IHRoZSBjaGFuZ2VzLCB5b3UgY2FuIGRlbGV0ZSBpbiB5b3UgY29kZQoKCiAgICAgICAgICB2YXIgdGVtcEluZGV4ID0gX3RoaXMyLm5ld0xpc3Quc3BsaWNlKGV2dC5vbGRJbmRleCwgMSlbMF07CgogICAgICAgICAgX3RoaXMyLm5ld0xpc3Quc3BsaWNlKGV2dC5uZXdJbmRleCwgMCwgdGVtcEluZGV4KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTsKZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7"},{"version":3,"sources":["drag-table.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAgEA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,MADA,EACA;AACA,UAAA,SAAA,GAAA;AACA,QAAA,SAAA,EAAA,SADA;AAEA,QAAA,KAAA,EAAA,MAFA;AAGA,QAAA,OAAA,EAAA;AAHA,OAAA;AAKA,aAAA,SAAA,CAAA,MAAA,CAAA;AACA;AARA,GAFA;AAYA,EAAA,IAZA,kBAYA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,IADA;AAEA,MAAA,KAAA,EAAA,IAFA;AAGA,MAAA,WAAA,EAAA,IAHA;AAIA,MAAA,SAAA,EAAA;AACA,QAAA,IAAA,EAAA,CADA;AAEA,QAAA,KAAA,EAAA;AAFA,OAJA;AAQA,MAAA,QAAA,EAAA,IARA;AASA,MAAA,OAAA,EAAA,EATA;AAUA,MAAA,OAAA,EAAA;AAVA,KAAA;AAYA,GAzBA;AA0BA,EAAA,OA1BA,qBA0BA;AACA,SAAA,OAAA;AACA,GA5BA;AA6BA,EAAA,OAAA,EAAA;AACA,IAAA,OADA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAEA,qBAAA,WAAA,GAAA,IAAA;AAFA;AAAA,uBAGA,wBAAA,KAAA,SAAA,CAHA;;AAAA;AAAA;AAGA,gBAAA,IAHA,oBAGA,IAHA;AAIA,qBAAA,IAAA,GAAA,IAAA,CAAA,KAAA;AACA,qBAAA,KAAA,GAAA,IAAA,CAAA,KAAA;AACA,qBAAA,WAAA,GAAA,KAAA;AACA,qBAAA,OAAA,GAAA,KAAA,IAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA,yBAAA,CAAA,CAAA,EAAA;AAAA,iBAAA,CAAA;AACA,qBAAA,OAAA,GAAA,KAAA,OAAA,CAAA,KAAA,EAAA;AACA,qBAAA,SAAA,CAAA,YAAA;AACA,kBAAA,KAAA,CAAA,OAAA;AACA,iBAFA;;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAaA,IAAA,OAbA,qBAaA;AAAA;;AACA,UAAA,EAAA,GAAA,KAAA,KAAA,CAAA,SAAA,CAAA,GAAA,CAAA,gBAAA,CAAA,yCAAA,EAAA,CAAA,CAAA;AACA,WAAA,QAAA,GAAA,oBAAA,MAAA,CAAA,EAAA,EAAA;AACA,QAAA,UAAA,EAAA,gBADA;AACA;AACA,QAAA,OAAA,EAAA,iBAAA,YAAA,EAAA;AACA;AACA;AACA,UAAA,YAAA,CAAA,OAAA,CAAA,MAAA,EAAA,EAAA;AACA,SANA;AAOA,QAAA,KAAA,EAAA,eAAA,GAAA,EAAA;AACA,cAAA,SAAA,GAAA,MAAA,CAAA,IAAA,CAAA,MAAA,CAAA,GAAA,CAAA,QAAA,EAAA,CAAA,EAAA,CAAA,CAAA;;AACA,UAAA,MAAA,CAAA,IAAA,CAAA,MAAA,CAAA,GAAA,CAAA,QAAA,EAAA,CAAA,EAAA,SAAA,EAFA,CAIA;;;AACA,cAAA,SAAA,GAAA,MAAA,CAAA,OAAA,CAAA,MAAA,CAAA,GAAA,CAAA,QAAA,EAAA,CAAA,EAAA,CAAA,CAAA;;AACA,UAAA,MAAA,CAAA,OAAA,CAAA,MAAA,CAAA,GAAA,CAAA,QAAA,EAAA,CAAA,EAAA,SAAA;AACA;AAdA,OAAA,CAAA;AAgBA;AA/BA;AA7BA,C","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- Note that row-key is necessary to get a correct row order. -->\n    <el-table ref=\"dragTable\" v-loading=\"listLoading\" :data=\"list\" row-key=\"id\" border fit highlight-current-row style=\"width: 100%\">\n      <el-table-column align=\"center\" label=\"ID\" width=\"65\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.id }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column width=\"180px\" align=\"center\" label=\"Date\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.timestamp | parseTime('{y}-{m}-{d} {h}:{i}') }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column min-width=\"300px\" label=\"Title\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.title }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column width=\"110px\" align=\"center\" label=\"Author\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.author }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column width=\"100px\" label=\"Importance\">\n        <template slot-scope=\"{row}\">\n          <svg-icon v-for=\"n in + row.importance\" :key=\"n\" icon-class=\"star\" class=\"icon-star\" />\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" label=\"Readings\" width=\"95\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.pageviews }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column class-name=\"status-col\" label=\"Status\" width=\"110\">\n        <template slot-scope=\"{row}\">\n          <el-tag :type=\"row.status | statusFilter\">\n            {{ row.status }}\n          </el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" label=\"Drag\" width=\"80\">\n        <template slot-scope=\"{}\">\n          <svg-icon class=\"drag-handler\" icon-class=\"drag\" />\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"show-d\">\n      <el-tag>The default order :</el-tag> {{ oldList }}\n    </div>\n    <div class=\"show-d\">\n      <el-tag>The after dragging order :</el-tag> {{ newList }}\n    </div>\n  </div>\n</template>\n\n<script>\nimport { fetchList } from '@/api/article'\nimport Sortable from 'sortablejs'\n\nexport default {\n  name: 'DragTable',\n  filters: {\n    statusFilter(status) {\n      const statusMap = {\n        published: 'success',\n        draft: 'info',\n        deleted: 'danger'\n      }\n      return statusMap[status]\n    }\n  },\n  data() {\n    return {\n      list: null,\n      total: null,\n      listLoading: true,\n      listQuery: {\n        page: 1,\n        limit: 10\n      },\n      sortable: null,\n      oldList: [],\n      newList: []\n    }\n  },\n  created() {\n    this.getList()\n  },\n  methods: {\n    async getList() {\n      this.listLoading = true\n      const { data } = await fetchList(this.listQuery)\n      this.list = data.items\n      this.total = data.total\n      this.listLoading = false\n      this.oldList = this.list.map(v => v.id)\n      this.newList = this.oldList.slice()\n      this.$nextTick(() => {\n        this.setSort()\n      })\n    },\n    setSort() {\n      const el = this.$refs.dragTable.$el.querySelectorAll('.el-table__body-wrapper > table > tbody')[0]\n      this.sortable = Sortable.create(el, {\n        ghostClass: 'sortable-ghost', // Class name for the drop placeholder,\n        setData: function(dataTransfer) {\n          // to avoid Firefox bug\n          // Detail see : https://github.com/RubaXa/Sortable/issues/1012\n          dataTransfer.setData('Text', '')\n        },\n        onEnd: evt => {\n          const targetRow = this.list.splice(evt.oldIndex, 1)[0]\n          this.list.splice(evt.newIndex, 0, targetRow)\n\n          // for show the changes, you can delete in you code\n          const tempIndex = this.newList.splice(evt.oldIndex, 1)[0]\n          this.newList.splice(evt.newIndex, 0, tempIndex)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style>\n.sortable-ghost{\n  opacity: .8;\n  color: #fff!important;\n  background: #42b983!important;\n}\n</style>\n\n<style scoped>\n.icon-star{\n  margin-right:2px;\n}\n.drag-handler{\n  width: 20px;\n  height: 20px;\n  cursor: pointer;\n}\n.show-d{\n  margin-top: 15px;\n}\n</style>\n"],"sourceRoot":"src/views/table"}]}